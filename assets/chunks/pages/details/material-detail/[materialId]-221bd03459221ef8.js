(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{3477:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/details/material-detail/[materialId]",function(){return r(8697)}])},7182:function(e,t,r){"use strict";r.d(t,{Z:function(){return z}});var a=r(7340),n=r(3366),i=r(7462),l=r(7294),o=r(512),s=r(4780),d=r(917),c=r(6643),u=r(4001),m=r(7527),h=r(1588),x=r(4867);function p(e){return(0,x.ZP)("MuiCircularProgress",e)}(0,h.Z)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);var f=r(5893);function Z(){let e=(0,a._)(["\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n"]);return Z=function(){return e},e}function j(){let e=(0,a._)(["\n  0% {\n    stroke-dasharray: 1px, 200px;\n    stroke-dashoffset: 0;\n  }\n\n  50% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -15px;\n  }\n\n  100% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -125px;\n  }\n"]);return j=function(){return e},e}function g(){let e=(0,a._)(["\n      animation: "," 1.4s linear infinite;\n    "]);return g=function(){return e},e}function v(){let e=(0,a._)(["\n      animation: "," 1.4s ease-in-out infinite;\n    "]);return v=function(){return e},e}let b=["className","color","disableShrink","size","style","thickness","value","variant"],y=e=>e,C,w,k,_,S=(0,d.F4)(C||(C=y(Z()))),D=(0,d.F4)(w||(w=y(j()))),R=e=>{let{classes:t,variant:r,color:a,disableShrink:n}=e,i={root:["root",r,"color".concat((0,c.Z)(a))],svg:["svg"],circle:["circle","circle".concat((0,c.Z)(r)),n&&"circleDisableShrink"]};return(0,s.Z)(i,p,t)},M=(0,m.ZP)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.variant],t["color".concat((0,c.Z)(r.color))]]}})(e=>{let{ownerState:t,theme:r}=e;return(0,i.Z)({display:"inline-block"},"determinate"===t.variant&&{transition:r.transitions.create("transform")},"inherit"!==t.color&&{color:(r.vars||r).palette[t.color].main})},e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&(0,d.iv)(k||(k=y(g(),0)),S)}),P=(0,m.ZP)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),T=(0,m.ZP)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.circle,t["circle".concat((0,c.Z)(r.variant))],r.disableShrink&&t.circleDisableShrink]}})(e=>{let{ownerState:t,theme:r}=e;return(0,i.Z)({stroke:"currentColor"},"determinate"===t.variant&&{transition:r.transitions.create("stroke-dashoffset")},"indeterminate"===t.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})},e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&!t.disableShrink&&(0,d.iv)(_||(_=y(v(),0)),D)});var z=l.forwardRef(function(e,t){let r=(0,u.i)({props:e,name:"MuiCircularProgress"}),{className:a,color:l="primary",disableShrink:s=!1,size:d=40,style:c,thickness:m=3.6,value:h=0,variant:x="indeterminate"}=r,p=(0,n.Z)(r,b),Z=(0,i.Z)({},r,{color:l,disableShrink:s,size:d,thickness:m,value:h,variant:x}),j=R(Z),g={},v={},y={};if("determinate"===x){let e=2*Math.PI*((44-m)/2);g.strokeDasharray=e.toFixed(3),y["aria-valuenow"]=Math.round(h),g.strokeDashoffset="".concat(((100-h)/100*e).toFixed(3),"px"),v.transform="rotate(-90deg)"}return(0,f.jsx)(M,(0,i.Z)({className:(0,o.Z)(j.root,a),style:(0,i.Z)({width:d,height:d},v,c),ownerState:Z,ref:t,role:"progressbar"},y,p,{children:(0,f.jsx)(P,{className:j.svg,ownerState:Z,viewBox:"".concat(22," ").concat(22," ").concat(44," ").concat(44),children:(0,f.jsx)(T,{className:j.circle,style:g,ownerState:Z,cx:44,cy:44,r:(44-m)/2,fill:"none",strokeWidth:m})})}))})},5858:function(e,t,r){"use strict";r.d(t,{Z:function(){return g}});var a=r(3366),n=r(7462),i=r(7294),l=r(512),o=r(4780),s=r(7527),d=r(3008),c=r(4001),u=r(6788),m=r(1588),h=r(4867);function x(e){return(0,h.ZP)("MuiDialogContentText",e)}(0,m.Z)("MuiDialogContentText",["root"]);var p=r(5893);let f=["children","className"],Z=e=>{let{classes:t}=e,r=(0,o.Z)({root:["root"]},x,t);return(0,n.Z)({},t,r)},j=(0,s.ZP)(u.Z,{shouldForwardProp:e=>(0,d.Z)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({});var g=i.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiDialogContentText"}),{className:i}=r,o=(0,a.Z)(r,f),s=Z(o);return(0,p.jsx)(j,(0,n.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:o,className:(0,l.Z)(s.root,i)},r,{classes:s}))})},2365:function(e,t,r){"use strict";var a=r(7462),n=r(3366),i=r(7294),l=r(512),o=r(4780),s=r(6788),d=r(7527),c=r(4001),u=r(7184),m=r(8984),h=r(5893);let x=["className","id"],p=e=>{let{classes:t}=e;return(0,o.Z)({root:["root"]},u.a,t)},f=(0,d.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),Z=i.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiDialogTitle"}),{className:o,id:s}=r,d=(0,n.Z)(r,x),u=p(r),{titleId:Z=s}=i.useContext(m.Z);return(0,h.jsx)(f,(0,a.Z)({component:"h2",className:(0,l.Z)(u.root,o),ownerState:r,ref:t,variant:"h6",id:null!=s?s:Z},d))});t.Z=Z},8697:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var a=r(5893),n=r(9008),i=r.n(n),l=r(1163),o=r(7294),s=r(7128),d=r(5678),c=r(2558),u=r(3490),m=r(7182),h=r(8426),x=r(55),p=r(6788),f=r(4277),Z=r(4952),j=r(4677),g=r(1589),v=r(8196),b=r(2365),y=r(110),C=r(5858),w=r(6727),k=r(8674),_=r(381),S=r.n(_),D=r(9783),R=r(720),M=r(389),P=r(762),T=r(4375),z=r(1919),N=r(2213),E=r(6912),A=r(2357);let W=e=>{let{user:t}=(0,c.a)(),[r,n]=(0,o.useState)({}),[i,l]=(0,o.useState)(null),[m,h]=(0,o.useState)(!1),[x,p]=(0,o.useState)(!1),[k,_]=(0,o.useState)(!1),W=(0,o.useCallback)(e=>{n(t=>({...t,[e.target.name]:e.target.value}))},[]);(0,o.useEffect)(()=>{t&&"admin"===t.role?(p(!0),h(!1)):t&&e.data&&t.id!==e.data.owner&&h(!0),e.data&&(l(e.data.material_id),n({material_title:e.data.material_title||"",team:e.data.team||"",origin:e.data.origin||"",codeCommande:e.data.codeCommande||"",codeBarres:e.data.codeBarres||"",size:e.data.size||"",levRisk:e.data.levRisk||"",date_depart:e.data.date_depart?new Date(e.data.date_depart):null}))},[t,e.data]);let F=(0,o.useCallback)(async e=>{if(e.preventDefault(),!r.date_depart){d.Am.error("Veuillez s\xe9lectionner une nouvelle date de d\xe9part");return}let t=r.date_depart?S()(r.date_depart).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"):null,a={...r,date_depart:t};if(i){let e=await fetch("".concat(s.Z.apiUrl,"/materials/").concat(i,"/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(e.ok)d.Am.success("Les d\xe9tails de la bouteille ont \xe9t\xe9 mis \xe0 jour avec succ\xe8s !"),window.location.reload();else{let t=JSON.parse(await e.text());d.Am.error(t.message,{autoClose:!1})}}},[r,i]);return e.data&&t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("form",{autoComplete:"off",noValidate:!0,onSubmit:F,children:(0,a.jsxs)(P.Z,{elevation:2,sx:{my:3,py:2},children:[(0,a.jsx)(T.Z,{subheader:m?"Seul l'administrateur ou le propri\xe9taire peut modifier ces informations":"Les informations peuvent \xeatre modifi\xe9es",title:"D\xe9tails sur la bouteille"}),(0,a.jsx)(z.Z,{sx:{pt:0},children:(0,a.jsx)(u.Z,{sx:{m:-1.5},children:(0,a.jsxs)(f.Z,{container:!0,spacing:3,children:[(0,a.jsx)(f.Z,{xs:12,md:6,children:(0,a.jsx)(N.Z,{fullWidth:!0,label:"Composition du gaz",disabled:m,name:"material_title",onChange:W,value:r.material_title||""})}),(0,a.jsx)(f.Z,{xs:12,md:6,children:(0,a.jsx)(N.Z,{fullWidth:!0,label:"Nom du responsable",name:"owner",disabled:!0,value:e.data.owner_details?"".concat(e.data.owner_details.first_name," ").concat(e.data.owner_details.last_name):"N/A"})}),(0,a.jsx)(f.Z,{xs:12,md:6,children:(0,a.jsx)(N.Z,{fullWidth:!0,label:"Equipe",name:"team",disabled:m,onChange:W,value:r.team||""})}),(0,a.jsx)(f.Z,{xs:12,md:6,children:(0,a.jsx)(N.Z,{fullWidth:!0,label:"Salle de stockage",name:"origin",disabled:m,onChange:W,value:r.origin||""})}),(0,a.jsx)(f.Z,{xs:12,md:6,children:(0,a.jsx)(N.Z,{fullWidth:!0,label:"Code barres Air Liquide",name:"codeCommande",disabled:m,onChange:W,value:r.codeCommande||""})}),(0,a.jsx)(f.Z,{xs:12,md:6,children:(0,a.jsx)(N.Z,{fullWidth:!0,label:"Code commande Air Liquide",name:"codeBarres",disabled:m,onChange:W,value:r.codeCommande||""})}),(0,a.jsx)(f.Z,{xs:12,md:6,children:(0,a.jsx)(N.Z,{fullWidth:!0,label:"Taille de la bouteille",name:"size",disabled:m,onChange:W,value:r.size||""})}),(0,a.jsx)(f.Z,{xs:12,md:6,children:(0,a.jsx)(N.Z,{fullWidth:!0,label:"Risque associ\xe9 \xe0 la bouteille",name:"levRisk",disabled:m,onChange:W,value:r.levRisk||""})}),(0,a.jsx)(f.Z,{item:!0,xs:12,md:6,children:(0,a.jsx)(R._,{dateAdapter:A.H,children:(0,a.jsx)(D.M,{label:"Date d\xe9parture",format:"dd/MM/yyyy",value:r.date_depart,onChange:e=>{n(t=>({...t,date_depart:e}))},disabled:m,slotProps:{textField:{helperText:"DD/MM/YYYY",fullWidth:!0}}})})})]})})}),(0,a.jsx)(E.Z,{}),!m&&(0,a.jsx)(f.Z,{xs:12,children:(0,a.jsx)(Z.Z,{sx:{justifyContent:"flex-end"},children:(0,a.jsx)(j.Z,{fullWidth:!0,onClick:()=>_(!0),variant:"contained",startIcon:(0,a.jsx)(g.Z,{fontSize:"small",children:(0,a.jsx)(M.Z,{})}),sx:{py:1.1,justifyContent:"center",textTransform:"none",backgroundColor:"rgb(1, 50, 32)",color:"white","&:hover":{backgroundColor:"rgb(1, 50, 32)"},gap:1,borderColor:"rgb(1, 50, 32)"},children:"Mise \xe0 jour des d\xe9tails"})})})]})}),(0,a.jsxs)(v.Z,{open:k,onClose:()=>_(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,a.jsx)(b.Z,{id:"alert-dialog-title",children:"Confirmer la mise \xe0 jour"}),(0,a.jsx)(y.Z,{children:(0,a.jsx)(C.Z,{id:"alert-dialog-description",children:"\xcates-vous s\xfbr de vouloir mettre \xe0 jour les d\xe9tails de cette bouteille?"})}),(0,a.jsxs)(w.Z,{children:[(0,a.jsx)(j.Z,{onClick:()=>_(!1),color:"primary",children:"Annuler"}),(0,a.jsx)(j.Z,{onClick:e=>{_(!1),F(e)},color:"success",autoFocus:!0,children:"Confirmer"})]})]})]}):(0,a.jsx)("p",{children:"Chargement en cours..."})};var F=r(2990);let I=o.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:t,"aria-labelledby":a},n),r?o.createElement("title",{id:a},r):null,o.createElement("path",{fillRule:"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 013.878.512.75.75 0 11-.256 1.478l-.209-.035-1.005 13.07a3 3 0 01-2.991 2.77H8.084a3 3 0 01-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 01-.256-1.478A48.567 48.567 0 017.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 013.369 0c1.603.051 2.815 1.387 2.815 2.951zm-6.136-1.452a51.196 51.196 0 013.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 00-6 0v-.113c0-.794.609-1.428 1.364-1.452zm-.355 5.945a.75.75 0 10-1.5.058l.347 9a.75.75 0 101.499-.058l-.346-9zm5.48.058a.75.75 0 10-1.498-.058l-.347 9a.75.75 0 001.5.058l.345-9z",clipRule:"evenodd"}))}),q={autoClose:2e3,hideProgressBar:!0,closeOnClick:!0,draggable:!0,progress:void 0},B=()=>{let e=(0,l.useRouter)(),t=(0,c.a)().user,{materialId:r}=e.query,[n,k]=(0,o.useState)(!1),[_,S]=(0,o.useState)(null),[D,R]=(0,o.useState)(""),[M,P]=(0,o.useState)(!1),[T,z]=(0,o.useState)(!1),[N,E]=(0,o.useState)(!0),A=(0,o.useCallback)(()=>{let e="",t="",r="",a=null;return"delete"===D&&(e="Supprimer la bouteille",t="\xcates-vous s\xfbr de vouloir supprimer cette bouteille ?",r="Supprimer",a=B),{title:e,content:t,buttonText:r,action:a}},[D]),B=(0,o.useCallback)(async()=>{try{(await fetch("".concat(s.Z.apiUrl,"/materials/").concat(r,"/"),{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok?(d.Am.success("La bouteille a \xe9t\xe9 supprim\xe9e avec succ\xe8s",{...q}),setTimeout(()=>{e.push("/")},1e3)):d.Am.error("Impossible de supprimer le mat\xe9riel, r\xe9essayez plus tard!!!",{...q})}catch(e){d.Am.error("Impossible de supprimer le mat\xe9riel, r\xe9essayez plus tard!!!",{...q})}k(!1)},[r,e]);return((0,o.useEffect)(()=>{r&&t&&(async()=>{E(!0);try{var e;let a=await fetch("".concat(s.Z.apiUrl,"/materials/").concat(r));if(!a.ok)throw Error("Material not found");let n=await a.json();S(n);let i=(null===(e=n.owner_details)||void 0===e?void 0:e.user_id)===t.user_id,l=t.is_staff||"admin"===t.role;P(i||l),z(!i&&!l)}catch(e){console.error("Error fetching data:",e)}finally{E(!1)}})()},[r,t]),N)?(0,a.jsx)(u.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,a.jsx)(m.Z,{})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:"D\xe9tails sur la bouteille"})}),(0,a.jsx)(u.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,a.jsx)(h.Z,{maxWidth:"lg",children:(0,a.jsxs)(x.Z,{spacing:3,children:[(0,a.jsx)(x.Z,{direction:"row",justifyContent:"space-between",spacing:4,children:(0,a.jsx)(p.Z,{variant:"h4",children:"D\xe9tails sur la bouteille"})}),(0,a.jsx)("div",{children:(0,a.jsxs)(f.Z,{container:!0,spacing:3,children:[(0,a.jsx)(f.Z,{xs:12,children:(0,a.jsx)(F.x,{data:_})}),(0,a.jsx)(f.Z,{xs:12,children:(0,a.jsx)(W,{data:_,isFormDisabled:T})}),M&&(0,a.jsxs)(f.Z,{xs:12,children:[(0,a.jsx)(Z.Z,{sx:{justifyContent:"flex-end"},children:(0,a.jsx)(j.Z,{fullWidth:!0,variant:"contained",color:"error",onClick:()=>{k(!0),R("delete")},startIcon:(0,a.jsx)(g.Z,{fontSize:"small",children:(0,a.jsx)(I,{})}),children:"Supprimer la bouteille"})}),(0,a.jsxs)(v.Z,{open:n,onClose:()=>k(!1),children:[(0,a.jsx)(b.Z,{children:A().title}),(0,a.jsx)(y.Z,{children:(0,a.jsx)(C.Z,{children:A().content})}),(0,a.jsxs)(w.Z,{children:[(0,a.jsx)(j.Z,{onClick:()=>k(!1),children:"Annuler"}),(0,a.jsx)(j.Z,{onClick:A().action,color:"error",children:A().buttonText})]})]})]})]})})]})})})]})};B.getLayout=e=>(0,a.jsx)(k.A,{children:e});var L=B},2990:function(e,t,r){"use strict";r.d(t,{x:function(){return f}});var a=r(5893),n=r(7294);r(5678);var i=r(762),l=r(1919),o=r(3490),s=r(8573),d=r(5895),c=r(6788),u=r(6912),m=r(4952),h=r(4677),x=r(5697),p=r.n(x);(0,r(7527).ZP)("span")(e=>{let{theme:t,ownerState:r}=e;return{alignItems:"center",backgroundColor:t.palette[r.color].alpha12,borderRadius:12,color:"dark"===t.palette.mode?t.palette[r.color].main:t.palette[r.color].dark,cursor:"default",display:"inline-flex",flexGrow:0,flexShrink:0,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(12),lineHeight:2,fontWeight:600,justifyContent:"center",letterSpacing:.5,minWidth:20,paddingLeft:t.spacing(1),paddingRight:t.spacing(1),textTransform:"uppercase",whiteSpace:"nowrap"}}),p().node,p().oneOf(["primary","secondary","error","info","warning","success"]);let f=e=>{let t=e.data,r="Gazotheque-".concat(null==t?void 0:t.material_id.toString().padStart(3,"0")),x=(0,n.useCallback)(()=>{let e=window.open("","_blank");e&&(e.document.write('\n        <html>\n          <head>\n            <style>\n              body { font-family: Arial, sans-serif; text-align: center; }\n              img { margin-top: 10px; }\n              h5 { margin-top: -50px; }\n            </style>\n          </head>\n          <body>\n            <img src="data:image/png;base64,'.concat(t.qrcode,'" alt="QRCode" style="width: 250px; height: 250px; object-fit: cover;"/>\n            <h5> ').concat(r," </h5>\n          </body>\n        </html>\n      ")),e.document.close())},[t,r]);return t?(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(l.Z,{children:(0,a.jsxs)(o.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"column",position:"relative"},children:[(0,a.jsx)(s.ZP,{container:!0,xs:12,sx:{justifyContent:"flex-end",position:"absolute"}}),!e.mode&&(0,a.jsx)(d.Z,{variant:"square",sx:{height:250,width:250},children:(0,a.jsx)("img",{src:"data:image/png;base64,".concat(t.qrcode),alt:"QRCode",style:{width:"100%",height:"100%",objectFit:"cover"}})}),(0,a.jsx)(c.Z,{gutterBottom:!0,variant:"h6",children:t.material_title}),(0,a.jsxs)(c.Z,{gutterBottom:!0,variant:"h6",children:["Owner : ",t.owner_details.first_name," ",t.owner_details.last_name]}),(0,a.jsxs)(c.Z,{color:"text.secondary",variant:"body2",children:["Contact : ",t.owner_details.email]}),(0,a.jsxs)(c.Z,{color:"text.secondary",variant:"body2",children:["Num\xe9ro de la bouteille : ",r]})]})}),!e.mode&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Z,{}),(0,a.jsx)(m.Z,{style:{display:"flex",justifyContent:"center"},children:(0,a.jsx)(h.Z,{variant:"text",onClick:x,children:"Imprimer le code QRCode et le num\xe9ro d'article"})})]})]}):(0,a.jsx)(i.Z,{children:(0,a.jsx)(l.Z,{children:(0,a.jsx)(c.Z,{gutterBottom:!0,variant:"h5",children:"Erreur : Aucun enregistrement de bouteille de gaz n'a \xe9t\xe9 trouv\xe9 dans le syst\xe8me.!!"})})})}}},function(e){e.O(0,[885,103,734,664,151,277,96,649,369,637,280,573,674,888,774,179],function(){return e(e.s=3477)}),_N_E=e.O()}]);