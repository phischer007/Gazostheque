(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(7126)}])},7126:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return V}});var s=t(5893),i=t(9008),n=t.n(i),a=t(7128),o=t(5678),l=t(2558),c=t(7294),d=t(3490),h=t(8426),x=t(4277),u=t(8196),j=t(2365),p=t(110),Z=t(5858),g=t(55),m=t(5895),f=t(6788),y=t(6727),b=t(4677),w=t(3950),v=t(8674),C=t(5697),k=t.n(C),E=t(2585),_=t(7634),I=t(1549),S=t(762),P=t(1919),T=t(1589);let z=e=>{let{difference:r,positive:t=!1,sx:i,value:n}=e,[o,l]=(0,c.useState)({LIPhy:0,IGE:0}),[d,h]=(0,c.useState)(!0);return((0,c.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(a.Z.apiUrl,"/materials/count-by-lab"));if(e.ok){let r=await e.json();l(r)}}catch(e){console.error("Error fetching materials by lab:",e)}finally{h(!1)}})()},[]),d)?(0,s.jsx)(f.Z,{children:"Loading..."}):(0,s.jsx)(S.Z,{sx:i,children:(0,s.jsxs)(P.Z,{children:[(0,s.jsxs)(g.Z,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:3,children:[(0,s.jsxs)(g.Z,{spacing:1,children:[(0,s.jsx)(f.Z,{color:"text.secondary",variant:"overline",children:"Bouteilles par laboratoire"}),(0,s.jsxs)(g.Z,{direction:"row",spacing:4,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(f.Z,{variant:"subtitle1",children:"LIPhy"}),(0,s.jsx)(f.Z,{variant:"h4",children:o.LIPhy||0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(f.Z,{variant:"subtitle1",children:"IGE"}),(0,s.jsx)(f.Z,{variant:"h4",children:o.IGE||0})]})]})]}),(0,s.jsx)(m.Z,{sx:{backgroundColor:"warning.main",height:56,width:56},children:(0,s.jsx)(T.Z,{children:(0,s.jsx)(I.Z,{})})})]}),r&&(0,s.jsx)(g.Z,{alignItems:"center",direction:"row",spacing:2,sx:{mt:2},children:(0,s.jsxs)(g.Z,{alignItems:"center",direction:"row",spacing:.5,children:[(0,s.jsx)(T.Z,{color:t?"success":"error",fontSize:"small",children:t?(0,s.jsx)(_.Z,{}):(0,s.jsx)(E.Z,{})}),(0,s.jsxs)(f.Z,{color:t?"success.main":"error.main",variant:"body2",children:[r,"%"]})]})})]})})};z.propTypes={difference:k().number,positive:k().bool,value:k().string,sx:k().object};var L=t(8745),A=t(7340),N=t(5152),U=t.n(N),D=t(7527);function G(){let e=(0,A._)([""]);return G=function(){return e},e}let R=U()(()=>Promise.all([t.e(279),t.e(229)]).then(t.bind(t,4394)),{loadableGenerated:{webpack:()=>[4394]},ssr:!1,loading:()=>(0,s.jsx)("div",{children:"Loading chart..."})}),B=(0,D.ZP)(R)(G()),O=e=>{let{sx:r}=e,t=(0,L.Z)(),[i,n]=(0,c.useState)({series:[],years:[]}),[o,l]=(0,c.useState)(!0),[h,x]=(0,c.useState)(null);(0,c.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(a.Z.apiUrl,"/materials/bar-chart"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();n(r)}catch(e){console.error("Error fetching material data:",e),x(e.message)}finally{l(!1)}})()},[]);let u=async()=>{l(!0),x(null);try{let e=await fetch("".concat(a.Z.apiUrl,"/materials/bar-chart"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();n(r)}catch(e){console.error("Error refreshing data:",e),x(e.message)}finally{l(!1)}},j={chart:{type:"bar",background:"transparent",stacked:!1,toolbar:{show:!1},zoom:{enabled:!1}},plotOptions:{bar:{horizontal:!1,borderRadius:4,columnWidth:"45%"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:i.years,title:{text:"Ann\xe9e"},axisBorder:{show:!0,color:t.palette.divider},axisTicks:{show:!0,color:t.palette.divider},labels:{style:{colors:t.palette.text.secondary}}},yaxis:{title:{text:"Nombre de bouteilles"},min:0,labels:{style:{colors:t.palette.text.secondary}}},fill:{opacity:1,colors:[t.palette.primary.light,t.palette.success.main]},colors:[t.palette.primary.light,t.palette.success.main],legend:{position:"top",horizontalAlign:"right",labels:{colors:t.palette.text.secondary}},tooltip:{y:{formatter:e=>"".concat(e," Bouteille").concat(1!==e?"s":"")}},grid:{borderColor:t.palette.divider,strokeDashArray:2,xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}}}};return o?(0,s.jsx)(S.Z,{sx:r,children:(0,s.jsx)(P.Z,{children:(0,s.jsx)(f.Z,{children:"Chargement des donn\xe9es de la bouteille..."})})}):h?(0,s.jsx)(S.Z,{sx:r,children:(0,s.jsxs)(P.Z,{children:[(0,s.jsxs)(f.Z,{color:"error",children:["Erreur: ",h]}),(0,s.jsx)(b.Z,{color:"inherit",size:"small",onClick:u,children:"R\xe9essayer"})]})}):(console.log("Chart Data:",i),(0,s.jsx)(S.Z,{sx:r,children:(0,s.jsx)(P.Z,{children:(0,s.jsxs)(g.Z,{spacing:2,children:[(0,s.jsxs)(g.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsx)(f.Z,{color:"text.secondary",variant:"overline",children:"Distribution annuelle de bouteilles par le laboratoire"}),(0,s.jsx)(b.Z,{color:"inherit",size:"small",onClick:u,disabled:o,children:o?"Chargement...":"Rafra\xeechir"})]}),(0,s.jsx)(d.Z,{sx:{width:"100%",height:"100%"},children:(0,s.jsx)(B,{height:450,options:j,series:i.series,type:"bar",width:"100%"})})]})})}))};O.propTypes={sx:k().object};var q=t(6254);let H=e=>{let{sx:r}=e,[t,i]=(0,c.useState)({total:0,percentageDiff:0,isPositive:!1,isLoading:!0,error:null});return((0,c.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(a.Z.apiUrl,"/materials/count"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();i({total:r.total_count,percentageDiff:r.percentage_diff,isPositive:r.is_positive,isLoading:!1,error:null})}catch(e){i(r=>({...r,isLoading:!1,error:e.message}))}})()},[]),t.isLoading)?(0,s.jsx)(S.Z,{sx:r,children:(0,s.jsx)(P.Z,{children:(0,s.jsx)(f.Z,{children:"Loading materials data..."})})}):t.error?(0,s.jsx)(S.Z,{sx:r,children:(0,s.jsx)(P.Z,{children:(0,s.jsxs)(f.Z,{color:"error",children:["Error: ",t.error]})})}):(0,s.jsx)(S.Z,{sx:r,children:(0,s.jsx)(P.Z,{children:(0,s.jsxs)(g.Z,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:3,children:[(0,s.jsxs)(g.Z,{spacing:1,children:[(0,s.jsx)(f.Z,{color:"text.secondary",variant:"overline",children:"Nombre total de bouteilles"}),(0,s.jsx)(f.Z,{variant:"h4",children:t.total.toLocaleString()||0})]}),(0,s.jsx)(m.Z,{sx:{backgroundColor:"primary.main",height:56,width:56},children:(0,s.jsx)(T.Z,{children:(0,s.jsx)(q.Z,{})})})]})})})};H.propTypes={sx:k().object};let W=()=>{let e=(0,l.a)(),r=e.user,[t,i]=(0,c.useState)(!1),[v,C]=(0,c.useState)("user"),k=(0,c.useCallback)(async()=>{try{let t=await fetch("".concat(a.Z.apiUrl,"/users/").concat(r.user_id,"/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:v})});if(t.ok){let r=await t.json();await e.updateUser(r.user_id),o.Am.success("Your account was successfully updated!"),window.location.reload()}else o.Am.error("An error occurred. Please try again later.",{autoClose:!1});window.sessionStorage.setItem("isNew",!1),i(!1)}catch(e){console.error("An unexpected error occurred:",e),o.Am.error("An unexpected error occurred. Please try again later.",{autoClose:!1})}},[v,e,r.user_id]),E={bgcolor:"primary.main",cursor:"pointer"};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(),{children:(0,s.jsx)("title",{children:"Tableau au bord | Gazotheque"})}),(0,s.jsx)(d.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,s.jsxs)(h.Z,{maxWidth:"xl",children:[(0,s.jsxs)(x.Z,{container:!0,spacing:3,children:[(0,s.jsx)(x.Z,{xs:12,sm:6,lg:3,children:(0,s.jsx)(H,{sx:{height:"100%"}})}),(0,s.jsx)(x.Z,{xs:12,sm:6,lg:3,children:(0,s.jsx)(z,{sx:{height:"100%"}})}),(0,s.jsx)(x.Z,{xs:12,lg:8,children:(0,s.jsx)(O,{})})]}),t&&(0,s.jsxs)(u.Z,{open:t,onClose:()=>i(!1),disableBackdropClick:!0,disableEscapeKeyDown:!0,children:[(0,s.jsx)(j.Z,{children:"Bienvenue \xe0 Gazotheque"}),(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(Z.Z,{children:"Veuillez choisir le type de compte que vous souhaitez"}),(0,s.jsxs)(x.Z,{container:!0,spacing:2,xs:12,sx:{my:2},justifyContent:"center",alignItems:"flex-start",children:[(0,s.jsx)(x.Z,{item:!0,xs:5,children:(0,s.jsxs)(g.Z,{direction:"column",alignItems:"center",justifyContent:"center",spacing:1,sx:{height:"100%"},children:[(0,s.jsx)(m.Z,{variant:"rounded",onClick:()=>{C("user"),console.log("USER")},sx:"user"===v?{...E}:{cursor:"pointer"},children:(0,s.jsx)(w.Z,{style:{fontSize:100}})}),(0,s.jsx)(f.Z,{align:"center",children:"User"}),(0,s.jsx)(f.Z,{align:"center",variant:"caption",children:"Un simple utilisateur peut voir l'inventaire."})]})}),(0,s.jsx)(x.Z,{item:!0,xs:5,children:(0,s.jsxs)(g.Z,{direction:"column",alignItems:"center",justifyContent:"center",spacing:1,sx:{height:"100%"},children:[(0,s.jsx)(m.Z,{variant:"rounded",onClick:()=>{C("owner"),console.log("OWNER")},sx:"owner"===v?{...E}:{cursor:"pointer"},children:(0,s.jsx)(w.Z,{style:{fontSize:100}})}),(0,s.jsx)(f.Z,{align:"center",children:"owner"}),(0,s.jsx)(f.Z,{align:"center",variant:"caption",children:"Les chefs d'\xe9quipe peuvent consulter et modifier l'inventaire des bouteilles de gaz."})]})}),(0,s.jsx)(x.Z,{item:!0,xs:5,children:(0,s.jsxs)(g.Z,{direction:"column",alignItems:"center",justifyContent:"center",spacing:1,sx:{height:"100%"},children:[(0,s.jsx)(m.Z,{variant:"rounded",onClick:()=>{C("admin"),console.log("ADMIN")},sx:"admin"===v?{...E}:{cursor:"pointer"},children:(0,s.jsx)(w.Z,{style:{fontSize:100}})}),(0,s.jsx)(f.Z,{align:"center",children:"Administrateur"}),(0,s.jsx)(f.Z,{align:"center",variant:"caption",children:"Un administrateur peut modifier le mat\xe9riel, d\xe9finir l'emplacement et g\xe9n\xe9rer un code QR."})]})})]})]}),(0,s.jsx)(y.Z,{children:(0,s.jsx)(b.Z,{onClick:k,color:"error",children:"V\xe9rifier"})})]})]})})]})};W.getLayout=e=>(0,s.jsx)(v.A,{children:e});var V=W}},function(e){e.O(0,[103,734,664,151,277,637,251,674,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);